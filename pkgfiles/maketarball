#! /usr/bin/env bash

if [ ! -r eternal_lands_license.txt ]
then
	echo "Please run from the elc directory"
	exit
fi

if [ -z "$1" ]
then
	echo "Specify version string"
	exit
fi
version="$1"

# remove stuff that's not required
echo "Cleaning up...."
rm -rf actor_defs books generic languages map_editor pawn pawn_scripts shader/data shaders skybox temlates eye_candy/textures
rm -f e3dlist.txt extentions.xml key.ini material_metadata.xml
find . -type d -name CVS -exec rm -rf {} \; &> /dev/null
find . -type d -name CVS -exec rm -rf {} \;
chmod -R -x *.{c,cpp,h}

# make the tar ball
echo "Making tar ball..."
tar cfz ../temp.tar.gz .
mkdir eternallands-${version}
cd eternallands-${version}
tar xfz ../../temp.tar.gz
cd ..
tar cfz ../eternallands-${version}.tar.gz eternallands-${version}
rm -rf eternallands-${version}
rm ../temp.tar.gz
ls -l ../eternallands-${version}.tar.gz
