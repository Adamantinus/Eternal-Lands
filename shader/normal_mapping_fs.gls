uniform sampler2D normal_texture;
uniform sampler2D base_texture;

varying vec3 light_dir;

void main(void)
{
	vec3 normal, texture;

	normal = texture2D(normal_texture, vec2(gl_TexCoord[0])).rgb;
	normal = gl_NormalMatrix * normalize(normal * 2.0f - 1.0f);
	texture = vec3(texture2D(base_texture, vec2(gl_TexCoord[1])));
	
	gl_FragColor.rgb = max(dot(normal, normalize(light_dir)), 0.0f)*texture;
}

